<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>trait_exists</h1>
</body>
</html>


<form method="post" action="" enctype="multipart/form-data">
    <label for="photo">Sélectionnez une photo :</label>
    <input type="file" name="photo" id="photo">
    <input type="submit" value="Ajouter la photo">
</form>


   
<?php
$hostname = 'localhost';
$username = 'root';
$password = '';
$database = 'bdclubprime';

try {
    $pdo = new PDO("mysql:host=$hostname;dbname=$database", $username, $password);

    if ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_FILES['photo']) && $_FILES['photo']['error'] === 0) {
        $photoContent = file_get_contents($_FILES['photo']['tmp_name']);

        $query = "INSERT INTO club (photoStade) VALUES (?)";
        $stmt = $pdo->prepare($query);

        $stmt->bindParam(1, $photoContent, PDO::PARAM_LOB);

        $stmt->execute();
        
        echo 'Photo ajoutée avec succès.';
    }

    $querySelect = "SELECT photoStade FROM club";
    $stmtSelect = $pdo->prepare($querySelect);

    $stmtSelect->execute();

    $result = $stmtSelect->fetchAll(PDO::FETCH_ASSOC);

    foreach ($result as $row) {
        $photoStade = $row['photoStade'];
        $imageData = base64_encode($photoStade);
        echo '<img src="data:image/jpeg;base64,' . $imageData . '" alt="Photo du stade">';
    }
} catch (PDOException $e) {
    echo 'Erreur de connexion : ' . $e->getMessage();
}

$pdo = null;
?>